<form [formGroup]="form" (ngSubmit)="sendForm()">
  <div class="row">
    <div class="col h-start">
      <label for="firstname" i18n>Vorname</label>
      <input
        enterkeyhint="next"
        id="firstname"
        autocomplete="given-name"
        formControlName="firstname"
        type="text"
      />

      <label for="lastname" i18n>Nachname</label>
      <input
        enterkeyhint="next"
        id="lastname"
        autocomplete="family-name"
        formControlName="lastname"
        type="text"
      />

      <label for="email" i18n>E-Mail</label>
      <input
        enterkeyhint="next"
        id="email"
        autocomplete="email"
        formControlName="email"
        type="email"
      />
    </div>

    <div class="col h-stretch msg">
      <label for="message" i18n>Nachricht</label>
      <textarea
        enterkeyhint="enter"
        #msg
        maxlength="5000"
        rows="30"
        id="message"
        autocomplete="off"
        formControlName="msg"
        type="text"
      ></textarea>
      <small class="ml-auto" [innerText]="msg.value.length + ' / 5000'"></small>
    </div>
  </div>

  @if (!blacklist) {
    @if (!sending) {
      @if (!sended) {
        @if (showError) {
          @if (form.invalid || form.get("email")?.value?.length === 0) {
            <p class="danger mt2" i18n>
              <b>Vorname</b>, <b>Nachname</b> und <b>Nachricht</b> sowie
              <b>E-Mail</b>
              wird benötigt.
            </p>
          }
          @if (form.get("email")?.invalid) {
            <p class="danger mt2" i18n>Gültige E-Mail wird benötigt.</p>
          }
        }
        @if (serverError) {
          <p class="danger mt2" [innerText]="serverError"></p>
        }

        <button class="btn primary" type="submit" i18n>Absenden</button>
      } @else {
        <p class="color-primary mt2 sended-text" i18n>
          Anfrage wurden erfolgreich übermittelt.
        </p>
      }
    } @else {
      <svg
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        style="
          margin: auto;
          background: rgb(255, 255, 255);
          display: block;
          shape-rendering: auto;
        "
        width="200px"
        height="200px"
        viewBox="0 0 100 100"
        preserveAspectRatio="xMidYMid"
      >
        <g transform="translate(80,50)">
          <g transform="rotate(0)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="1">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.875s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.875s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(71.21320343559643,71.21320343559643)">
          <g transform="rotate(45)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.875">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.75s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.75s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(50,80)">
          <g transform="rotate(90)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.75">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.625s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.625s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(28.786796564403577,71.21320343559643)">
          <g transform="rotate(135)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.625">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.5s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.5s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(20,50.00000000000001)">
          <g transform="rotate(180)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.5">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.375s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.375s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(28.78679656440357,28.786796564403577)">
          <g transform="rotate(225)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.375">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.25s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.25s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(49.99999999999999,20)">
          <g transform="rotate(270)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.25">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="-0.125s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="-0.125s"
              ></animate>
            </circle>
          </g>
        </g>
        <g transform="translate(71.21320343559643,28.78679656440357)">
          <g transform="rotate(315)">
            <circle cx="0" cy="0" r="6" fill="#0f7dff" fill-opacity="0.125">
              <animateTransform
                attributeName="transform"
                type="scale"
                begin="0s"
                values="1.5 1.5;1 1"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
              ></animateTransform>
              <animate
                attributeName="fill-opacity"
                keyTimes="0;1"
                dur="1s"
                repeatCount="indefinite"
                values="1;0"
                begin="0s"
              ></animate>
            </circle>
          </g>
        </g>
      </svg>
    }
  } @else {
    <p class="danger mt2" i18n>
      Ihre IP-Adresse wurde auf die Blacklist gesetzt, weil Sie ungewöhnlich
      viele Anfragen an den Server gesendet haben! Sollten diese Anfragen nicht
      böswillig durchgeführt worden sein, wenden Sie sich bitte an den Support
      über
      <b
        ><a class="danger" href="mailto:info@snaptab.ch?subject=Support"
          >info&#64;snaptab.ch</a
        ></b
      >.
    </p>
  }
</form>
